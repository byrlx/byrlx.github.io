---
layout: post
title: resolve-fx
categories: [Lisp]
tags: [Lisp, Emacs]
---

<p>
本文是 <a href="http://book.douban.com/subject/1148282/">SICP</a> 的第一章的一段阅读笔记, 旨在求解函数 <b>f(x)=0</b> 在一段
区间内的解, 同时更深入了解一下Lisp "过程同时也为数据" 的精髓.
</p>

<div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1">高阶抽象lxsearch</h2>
<div class="outline-text-2" id="text-orgheadline1">
<p>
在开始讲解代码之前, 需要先讲一下程序对方程 f(x) 做一些限制,在下面的
程序中, 需要传入区间参数(a, b), 方程f(x)在该区间上必须是连续函数, 
且 f(a)&lt;0, f(b)&gt;0. 这样在该区间上必存在 x 使得 <b>f(x)=0</b>; 
</p>

<p>
基于上面的限制, 使用"类似折半查找"的方法来解方程, 首先查找去该区间的
中间值 mid=(a+b)/2, 判断 f(mid)的值, 如果 f(mid)&gt;0, 在解在区间(a,mid),
否则解在区间 (mid, b), 根据此规则递归求解.
</p>

<p>
先看一下函数的源码, 这里定义了函数lxsearch, 该函数接受三个参数: 
</p>
<ul class="org-ul">
<li>f 即函数 f(x)</li>
<li>a 为一个参数使得 f(a) &lt; 0</li>
<li>b 为参数使得 f(b) &gt; 0</li>
</ul>
<p>
下面为该函数的流程(<b>注</b>:代码中lxaverage和lxclose-enough等基本函数的
定义未给出):
</p>
<ol class="org-ol">
<li>定义局部变量mid为a和b的平均数</li>
<li>判断a和b的差值是否已经足够接近, 如果是, 返回mid</li>
<li>如果差值还不接近, 计算f(mid)的值
<ol class="org-ol">
<li>如果f(mid)&gt;0, 递归调用lxsearch计算区间(a, mid)</li>
<li>否则, 如果f(mid)&lt;0, 递归调用lxsearch计算区间(mid, b)</li>
<li>如果f(mid)=0, 直接返回mid.</li>
</ol></li>
</ol>
<pre class="example">
(defun lxsearch (f a b)
  (let ((mid (lxaverage a b)))
    (if (lxclose-enough? a b)
	(lxformat-float mid)
      (let ((test-value (funcall f mid)))
	(cond ((&gt; test-value 0) (lxsearch f a mid)) 
	      ((&lt; test-value 0) (lxsearch f mid b))
	      (t (lxformat-float mid)))))))
</pre>

<p>
这里需要说明的是lxsearch是一个很抽象的定义, 这里的f可以为我们在学校里
学习过的任意函数, 只要它满足前面中提到的限制即可. 下面通过几个实例来
看一下lxsearch的使用.
</p>
</div>
</div>

<div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4">lxsearch使用实例</h2>
<div class="outline-text-2" id="text-orgheadline4">
</div><div id="outline-container-orgheadline2" class="outline-3">
<h3 id="orgheadline2">计算方程 x^2 - 52x + 100 = 0 在区间 (10, 100)上的解</h3>
<div class="outline-text-3" id="text-orgheadline2">
<p>
在计算之前, 我们先用代码写出该方程:
</p>
<pre class="example">
(defun f (x)
  (+ (- (* x x)
	(* 52 x))
     100))
</pre>

<p>
然后将函数f作为参数传给lxsearch, 就可以得到解为50
</p>
<pre class="example">
(lxsearch 'f 10 100)
</pre>
</div>
</div>
<div id="outline-container-orgheadline3" class="outline-3">
<h3 id="orgheadline3">方程 x^3 -100x = 0, 区间(1,11)</h3>
<div class="outline-text-3" id="text-orgheadline3">
<p>
前面可以讲过, lxsearch是一个高阶的抽象函数, 我们可以将满足条件的
任意方程传给他来求解函数的解, 这里通过传入一个lambda表达式来
展示lambda表达式如何作为函数参数.
</p>
<pre class="example">
(lxsearch
 '(lambda (x) (- (lxcube x) (* 100 x)))
 1
 11)
</pre>
</div>
</div>
</div>
