<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.43 in css mode. -->
<html>
  <head>
    <title>2015-04-15-Android-Gradle.org</title>
    <style type="text/css">
    <!--
      body {
        color: #DCDCCC;
        background-color: #3F3F3F;
      }
      .bold {
        /* bold */
        font-weight: bold;
      }
      .italic {
        /* italic */
        font-style: italic;
      }
      .org-block {
        /* org-block */
        color: #009acd;
      }
      .org-block-begin-line {
        /* org-block-begin-line */
        color: #7F9F7F;
      }
      .org-block-end-line {
        /* org-block-end-line */
        color: #7F9F7F;
      }
      .org-level-1 {
        /* org-level-1 */
        color: #DFAF8F;
        font-size: 130%;
        text-decoration: overline;
      }
      .org-level-2 {
        /* org-level-2 */
        color: #BFEBBF;
        font-size: 120%;
      }
      .org-level-3 {
        /* org-level-3 */
        color: #7CB8BB;
      }
      .org-link {
        /* org-link */
        color: #D0BF8F;
        text-decoration: underline;
      }
      .org-meta-line {
        /* org-meta-line */
        color: #7F9F7F;
      }
      .org-target {
        /* org-target */
        text-decoration: underline;
      }
      .org-todo {
        /* org-todo */
        color: #ff6347;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
<span class="org-meta-line">#+SEQ_TODO: TODO(t!) DONE(d@/!)</span>
<span class="org-meta-line">#+OPTIONS: ^:nil</span>
<span class="org-meta-line">#+OPTIONS: toc:t H:2</span>

<span class="org-block-begin-line">#+BEGIN_HTML
</span><span class="org-block">---
layout: post
title: Android Gradle Plugin User Guide &#25991;&#26723;&#32763;&#35793; 
Category: [Android]
description: [Android Gradle&#25554;&#20214;&#29992;&#25143;&#25991;&#26723;&#20013;&#25991;&#32763;&#35793;]
tag: [android, translate]
---
</span><span class="org-block-end-line">#+END_HTML
</span>
(&#25345;&#32493;&#26356;&#26032;)

&#21407;&#25991;&#22320;&#22336; <span class="org-link"><a href="http://tools.android.com/tech-docs/new-build-system/user-guide#TOC-Introduction">http://tools.android.com/tech-docs/new-build-system/user-guide#TOC-Introduction</a></span>.

<span class="org-level-1">* &#20171;&#32461;</span>
&#26412;&#25991;&#26723;&#38024;&#23545;&gt;=0.9&#29256;&#26412;&#30340;gradle&#25554;&#20214;,&#20043;&#21069;&#30340;&#25554;&#20214;&#19981;&#20860;&#23481;.
<span class="org-level-2">** Android&#26032;&#32534;&#35793;&#31995;&#32479;&#30340;&#30446;&#26631;</span>
&#21253;&#25324;:
+ &#20195;&#30721;&#21644;&#36164;&#28304;&#37325;&#29992;&#26356;&#26041;&#20415;.
+ &#26356;&#23481;&#26131;&#29983;&#25104;&#24212;&#29992;&#30340;&#22810;&#20010;"&#24418;&#24335;", &#20363;&#22914;&#22810;&#20010;APK&#25991;&#20214;&#25110;&#22810;&#20010;flavor.
+ &#26356;&#23481;&#26131;&#37197;&#32622;/&#25193;&#23637;/&#23450;&#21046;&#32534;&#35793;&#36807;&#31243;.
+ &#26356;&#22909;&#30340;IDE&#25972;&#21512;.

<span class="org-level-2">** &#20026;&#20160;&#20040;&#36873;&#25321;Gradle?</span>
Gradle&#26159;&#20010;&#39640;&#32423;&#30340;&#32534;&#35793;&#31995;&#32479;,&#33021;&#22815;&#36890;&#36807;&#25554;&#20214;&#30340;&#26041;&#24335;&#24314;&#31435;&#23458;&#21046;&#21270;&#30340;&#32534;&#35793;&#36923;&#36753;.
Gradle&#30340;&#19968;&#20123;&#36855;&#20154;&#29305;&#36136;&#21253;&#25324;:
+ &#20351;&#29992;DSL(Domain Specific Language)&#25551;&#36848;&#21644;&#25805;&#20316;&#32534;&#35793;&#36923;&#36753;.
+ &#32534;&#35793;&#25991;&#20214;&#22522;&#20110;Groovy,&#36890;&#36807;&#28151;&#21512;DSL&#20803;&#32032;&#22768;&#26126;&#21644;&#20195;&#30721;&#25805;&#25511;&#26469;&#25552;&#20379;&#23458;&#21046;&#21270;&#36923;&#36753;.
+ &#20869;&#32622;Maven/Ivy&#20381;&#36182;.
+ &#28789;&#27963;&#24615;&#24456;&#39640;.
+ &#25554;&#20214;&#21487;&#20197;&#25552;&#20379;&#33258;&#23450;&#20041;&#30340;DSL&#21644;API.
+ &#25552;&#20379;&#20102;&#24456;&#22909;&#30340;IDE&#25972;&#21512;&#25509;&#21475;.
<span class="org-level-1">* &#35201;&#27714;</span>
1. Gradle1.10&#20197;&#19978;,&#25554;&#20214;0.11.1.
2. Android SDK 19.
<span class="org-level-1">* &#22522;&#30784;&#37197;&#32622;</span>
&#22312;&#24037;&#31243;&#36319;&#30446;&#24405;&#19979;&#23450;&#20041;&#20102; build.gradle &#25551;&#36848;&#24037;&#31243;&#30340;&#32534;&#35793;&#20449;&#24687;.
<span class="org-level-2">** &#31616;&#21333;&#37197;&#32622;&#25991;&#20214;</span>
1. &#23545;&#20110;&#19968;&#20010;&#31616;&#21333;&#30340;java&#24037;&#31243;,&#38656;&#35201;&#22312;build.gradle&#37324;&#21152;&#20837;
<span class="org-block-begin-line">    #+BEGIN_EXAMPLE 
</span><span class="org-block">     apply plugin: 'java'
</span><span class="org-block-end-line">    #+END_EXAMPLE
</span>   &#19978;&#36848;&#20195;&#30721;&#34920;&#31034;&#20351;&#29992;java&#25554;&#20214;,&#35813;&#25554;&#20214;&#38543;&#30528;Gradle&#21253;&#21457;&#24067;.&#21487;&#20197;&#20351;&#29992;&#35813;&#25554;&#20214;&#26469;
   &#32534;&#35793;&#21644;&#27979;&#35797;java&#24212;&#29992;&#31243;&#24207;.
2. &#23545;&#20110;&#19968;&#20010;&#31616;&#21333;&#30340;Android&#24037;&#31243;,build.gradle&#30340;&#20869;&#23481;&#19968;&#33324;&#20026;
   (&#35813;&#25991;&#20214;&#19968;&#33324;&#20301;&#20110;&#27599;&#20010;&#27169;&#22359;&#30340;&#30446;&#24405;&#19979;&#38754;):
<span class="org-block-begin-line">   #+BEGIN_EXAMPLE 
</span><span class="org-block">buildscript {
    repositories {
        mavenCentral()
    }

    dependencies {
        classpath 'com.android.tools.build:gradle:0.11.1'
    }
}

apply plugin: 'android'

android {
    compileSdkVersion 19
    buildToolsVersion "19.0.0"
}
</span><span class="org-block-end-line">   #+END_EXAMPLE
</span>   &#19978;&#36848;&#20195;&#30721;&#25551;&#36848;&#20102;Android&#32534;&#35793;&#30340;&#19977;&#20010;&#26041;&#38754;:
   + buildscript{...}: &#37197;&#32622;&#32534;&#35793;&#39537;&#21160;&#20195;&#30721;.
     repositories&#25551;&#36848;&#20102;&#20351;&#29992;&#30340;&#20179;&#24211;&#31867;&#22411;.&#36825;&#37324;&#20351;&#29992;MavenCentral()&#20179;&#24211;.&#21516;&#26102;
     dependencies&#25551;&#36848;&#20102;&#32534;&#35793;&#38656;&#35201;&#20351;&#29992;&#30340;&#20381;&#36182;.&#36825;&#37324;&#20351;&#29992;0.11.1&#29256;&#26412;&#30340;build gradle.
     &#27880;: &#36825;&#37324;&#21482;&#26159;&#23450;&#20041;&#20102;&#32534;&#35793;&#30456;&#20851;&#30340;&#20195;&#30721;,&#19982;&#39033;&#30446;&#26080;&#20851;.&#39033;&#30446;&#38656;&#35201;&#23450;&#20041;&#33258;&#24049;&#30340;&#20179;&#24211;&#21644;
     &#20381;&#36182;.
   + apply plugin: 'android'. &#23450;&#20041;&#20351;&#29992;android&#25554;&#20214;.
   + <span class="org-target">&lt;&lt;andriod&gt;&gt;</span>{...}&#27573;&#25551;&#36848;&#20102;Android DSL&#30340;&#20837;&#21475;.
     &#40664;&#35748;&#24773;&#20917;&#19979;&#21482;&#38656;&#35201;&#23450;&#20041;&#32534;&#35793;&#30446;&#26631;&#21644;&#32534;&#35793;&#24037;&#20855;&#29256;&#26412;.&#21363; compileSdkVersion &#21644;
     buildtoolsVersion&#23383;&#27573;.
     + &#27880;:&#36825;&#37324;&#21482;&#33021;&#23450;&#20041; <span class="italic">/*android*/</span> plugin,&#22914;&#26524;&#20351;&#29992; <span class="italic">/*java*/</span> plugin&#20250;&#25253;&#38169;.
     + &#27880;:&#23545;&#20110;&#32534;&#35793;&#20351;&#29992;&#30340;sdk&#30446;&#24405;,&#21487;&#20197;&#22312;&#24037;&#31243;&#30446;&#24405;&#19979;&#23450;&#20041; <span class="bold">*local.properties*</span> &#25991;&#20214;
       &#24182;&#22312;&#20854;&#20013;&#37197;&#32622; <span class="bold">*sdk.dir*</span>.
       &#25110;&#32773;&#20063;&#21487;&#20197;&#23450;&#20041;&#20840;&#23616;&#21464;&#37327; ANDROID_HOME.
<span class="org-level-2">** &#24037;&#31243;&#32467;&#26500;</span>
<span class="org-level-3">*** &#40664;&#35748;&#30446;&#24405;&#32467;&#26500;</span>
&#19978;&#33410;&#25551;&#36848;&#30340;&#37197;&#32622;&#25991;&#20214;&#38656;&#35201;&#19968;&#20010;&#40664;&#35748;&#30340;&#30446;&#24405;&#32467;&#26500;.&#20294;&#26159;,gradle&#36981;&#24490;
&#32422;&#23450;&#20248;&#20110;&#37197;&#32622;(convention over configuration)&#30340;&#27010;&#24565;,&#24182;&#22312;
&#38656;&#35201;&#30340;&#26102;&#20505;&#25552;&#20379;&#37197;&#32622;&#40664;&#35748;&#20540;.
source sets&#19968;&#33324;&#26377;&#20004;&#20010;&#30446;&#24405;:&#28304;&#30721;&#30446;&#24405;&#21644;&#27979;&#35797;&#30446;&#24405;.&#20182;&#20204;&#30340;&#20301;&#32622;:
   + src/main/
   + src/androidTest/
&#27599;&#20010;&#30446;&#24405;&#37117;&#22914;&#26524;&#19979;&#30340;&#19968;&#20123;&#23376;&#30446;&#24405;:
   + java/
   + resources/ (&#36825;&#20004;&#20010;&#23383;&#27573;&#23545;Java&#21644;Android&#25554;&#20214;&#37117;&#36866;&#29992;)
&#23545;&#20110;Android&#25554;&#20214;,&#36824;&#26377;&#19968;&#20123;&#39069;&#22806;&#30340;&#30446;&#24405;&#21644;&#25991;&#20214;:
   + AndroidManifest.xml
   + res/
   + assets/
   + aidl/
   + rs/
   + jni/
&#27880;: src/androidTest/AndroidManifest.xml&#24182;&#19981;&#38656;&#35201;,AS&#20250;&#33258;&#21160;&#21019;&#24314;.
     
<span class="org-level-3">*** &#37197;&#32622;&#30446;&#24405;&#32467;&#26500;</span>
1. java&#24037;&#31243;
   gradle&#21516;&#26102;&#25903;&#25345;&#30446;&#24405;&#37197;&#32622;.&#20363;&#22914;&#23545;&#20110;&#19968;&#20010;java&#24037;&#31243;,&#21487;&#20197;&#20351;&#29992;&#22914;&#19979;&#37197;&#32622;:
<span class="org-block-begin-line">   #+BEGIN_EXAMPLE 
</span><span class="org-block">sourceSets {
    main {
        java {
            srcDir 'src/java'
        }
        resources {
            srcDir 'src/resources'
        }
    }
}
</span><span class="org-block-end-line">   #+END_EXAMPLE
</span>   &#27880;: srcDir&#20250;&#33258;&#21160;&#23558;&#30446;&#24405;&#28155;&#21152;&#21040;&#24050;&#23384;&#30340;"&#28304;&#30721;"&#21015;&#34920;&#20013;.

   &#21487;&#20197;&#20351;&#29992; <span class="bold">*srcDirs*</span> &#20851;&#38190;&#23383;&#26469;&#26367;&#25442;&#40664;&#35748;&#30340;source&#30446;&#24405;.&#35813;&#23383;&#27573;&#21518;&#38754;&#36319;&#30528;
   &#36335;&#24452;&#25968;&#32452;,&#20363;&#22914;:
<span class="org-block-begin-line">   #+BEGIN_EXAMPLE 
</span><span class="org-block">sourceSets {
    main.java.srcDirs = ['src/java']
    main.resources.srcDirs = ['src/resources']
}
</span><span class="org-block-end-line">   #+END_EXAMPLE
</span>2. Android&#24037;&#31243;
   android&#25554;&#20214;&#20351;&#29992;&#30340;&#35821;&#27861;&#36319;&#19978;&#19968;&#33410;&#30456;&#21516;.&#20294;&#26159;&#20250;&#25918;&#22312;<span class="org-link"><a href="andriod">andriod</a></span>&#23383;&#27573;&#20013;.
   &#19979;&#38754;&#26159;&#19968;&#27573;&#23454;&#20363;&#20195;&#30721;,&#29992;&#20110;&#26144;&#23556;&#32769;&#30340;android&#26550;&#26500;&#21040;gradle&#20013;:
<span class="org-block-begin-line">   #+BEGIN_EXAMPLE 
</span><span class="org-block">android {
    sourceSets {
        main {
            manifest.srcFile 'AndroidManifest.xml'
            java.srcDirs = ['src']
            resources.srcDirs = ['src']
            aidl.srcDirs = ['src']
            renderscript.srcDirs = ['src']
            res.srcDirs = ['res']
            assets.srcDirs = ['assets']
        }

        androidTest.setRoot('tests')
    }
}
</span><span class="org-block-end-line">   #+END_EXAMPLE
</span>   &#30001;&#20110;&#32769;&#26550;&#26500;&#23558;&#25152;&#26377;&#30340;&#28304;&#25991;&#20214;&#25918;&#21040;&#19968;&#20010;&#30446;&#24405;,&#25152;&#20197;&#36825;&#37324;&#38656;&#35201;&#35774;&#32622;&#25152;&#26377;&#32452;&#20214;&#30340;
   &#36335;&#24452;&#20026;"src".
   setRoot()&#20989;&#25968;&#21487;&#20197;&#23558;&#28304;&#30721;&#30446;&#24405;&#31227;&#21160;&#21040;&#26032;&#30446;&#24405;.&#20363;&#22914;&#36825;&#37324;&#23558; src/androidTest/* 
   &#31227;&#21160;&#21040; test/*.
<span class="org-level-2">** &#32534;&#35793;&#20219;&#21153;</span>
<span class="org-level-3">*** &#19968;&#33324;&#20219;&#21153;</span>
&#20351;&#29992;&#25554;&#20214;&#20250;&#33258;&#21160;&#29983;&#25104;&#19968;&#20010;&#21487;&#20197;&#36816;&#34892;&#30340;&#20219;&#21153;&#38598;.&#19968;&#33324;&#30340;&#20219;&#21153;&#38598;&#21253;&#25324;:
+ assemble
  &#29983;&#25104;&#24037;&#31243;&#30340;&#36755;&#20986; outputs.
+ check
  &#25191;&#34892;&#25152;&#26377;&#30340;&#26816;&#26597;.
+ build
  &#21516;&#26102;&#25191;&#34892;assemble&#21644;check.
+ clean 
  &#28165;&#29702;&#24037;&#31243;&#30340;&#36755;&#20986;.
assemble/check/build&#26412;&#36523;&#24182;&#19981;&#20570;&#20160;&#20040;&#23454;&#38469;&#24037;&#20316;.&#20182;&#20204;&#26159;&#19968;&#20123;"&#38057;&#23376;"
&#20219;&#21153;,&#21487;&#20197;&#28155;&#21152;"&#30495;&#23454;"&#30340;&#20219;&#21153;&#26469;&#23436;&#25104;&#20855;&#20307;&#24037;&#20316;.&#36825;&#31181;&#29305;&#28857;&#21487;&#20197;&#23454;&#29616;&#23545;&#20110;
&#19981;&#21516;&#31867;&#22411;&#30340;&#24037;&#31243;(java/android/...), &#21487;&#20197;&#35843;&#29992;&#30456;&#21516;&#30340;&#20219;&#21153;.
&#20363;&#22914;:&#20351;&#29992; <span class="bold">*findbugs*</span> &#25554;&#20214;&#20250;&#21019;&#24314;&#19968;&#20010;&#26032;&#20219;&#21153;,&#24182;&#23558; <span class="bold">*check*</span> &#20219;&#21153;&#20381;&#36182;
&#21040;&#26032;&#20219;&#21153;&#19978;,&#36825;&#26679;,&#24403;&#21435;&#35843;&#29992;check&#20219;&#21153;&#26159;&#20250;&#35302;&#21457;&#26032;&#20219;&#21153;.

&#22312;&#21629;&#20196;&#34892;: &#21487;&#20197;&#20351;&#29992;&#19979;&#36848;&#21629;&#20196;&#36816;&#34892; <span class="bold">*&#39640;&#23618;&#27425;*</span> &#30340;&#20219;&#21153;: gradle task.
<span class="bold">*gradlw tasks -all*</span> &#21487;&#20197;&#26174;&#31034;&#25152;&#26377;&#30340;&#20219;&#21153;&#21450;&#20854;&#20381;&#36182;.
<span class="org-level-3">*** </span><span class="org-todo">TODO</span><span class="org-level-3"> Java&#24037;&#31243;&#20219;&#21153;</span>
<span class="org-level-3">*** Android&#24037;&#31243;&#20219;&#21153;</span>
Android&#24037;&#31243;&#30340;&#20219;&#21153;&#19968;&#33324;&#21253;&#25324;:
+ assemble:  &#29983;&#25104;&#36755;&#20986;
+ check: &#26816;&#26597;
+ connectedCheck: &#25191;&#34892;&#26816;&#26597;&#21160;&#20316;,&#38656;&#35201;&#19968;&#20010;&#21487;&#20197;&#36830;&#25509;&#30340;&#35774;&#22791;&#25110;&#27169;&#25311;&#22120;.&#35813;&#20219;&#21153;&#20250;&#21516;&#26102;
  &#22312;&#26426;&#22120;&#19978;&#36816;&#34892;.
+ deviceCheck: &#20351;&#29992;API&#36830;&#25509;&#36828;&#31243;&#26426;&#22120;.
+ build: &#21516;&#26102;&#25191;&#34892;assemble&#21644;check.
+ clean: &#28165;&#29702;&#36755;&#20986;.

&#27599;&#20010;Android&#24037;&#31243;,&#33267;&#23569;&#21253;&#21547;&#20004;&#20010;&#36755;&#20986;: debug APK&#21644;release APK. &#36825;&#20004;&#31181;&#31867;&#22411;&#30340;APK&#20998;&#21035;
&#26377;&#23545;&#24212;&#30340;"&#38057;&#23376;"&#20219;&#21153;&#21487;&#20197;&#20998;&#21035;&#32534;&#35793;:
+ assemble
  + assembleDebug
  + assembleRelease
&#25191;&#34892;assemble&#20219;&#21153;&#20250;&#21516;&#26102;&#36816;&#34892;&#36825;&#20004;&#20010;&#23376;&#20219;&#21153;&#29983;&#25104;&#20004;&#20010;APK.

&#25552;&#31034;: Gradle&#25903;&#25345;"&#39548;&#23792;"&#26684;&#24335;&#30340;&#20219;&#21153;&#32553;&#20889;.&#25152;&#26377; "gradle assembleRelease"&#21487;&#20197;&#31616;&#20889;&#20026;
"gradle aR"(&#24517;&#39035;&#20445;&#35777;&#21482;&#26377;&#19968;&#20010;&#20219;&#21153;&#21487;&#20197;&#31616;&#20889;&#25104;&#36825;&#26679;).

&#23545;&#20110;check&#31867;&#22411;&#30340;&#20219;&#21153;,&#20182;&#20204;&#26377;&#33258;&#24049;&#30340;&#20381;&#36182;:
+ check
  + lint
+ connectedCheck
  + connectedAndroidTest
  + connectedUiAutomatorTest

&#21516;&#26102;,gradle&#25554;&#20214;&#23545;&#20110;&#25152;&#26377;&#30340;&#32534;&#35793;&#31867;&#22411;(debug/release/test),&#37117;&#21019;&#24314;&#20102;install/uninstall
&#20219;&#21153;.
<span class="org-level-2">** &#22522;&#30784;&#30340;&#32534;&#35793;&#23458;&#21046;&#21270;</span>
Android&#25554;&#20214;&#25552;&#20379;&#20102;&#20016;&#23500;&#30340;DSL&#35821;&#35328;&#26469;&#23454;&#29616;&#32534;&#35793;&#31995;&#32479;&#30340;&#23458;&#21046;&#21270;.
<span class="org-level-3">*** Manifest&#39033;</span>
&#20351;&#29992;DSL,&#21487;&#20197;&#37197;&#32622;&#22914;&#19979;&#30340;manifest&#39033;:
+ minSdkVersion
+ targetSdkVersion
+ versionCode
+ versionName
+ applicationId
+ &#27979;&#35797;&#31243;&#24207;&#21253;&#21517;
+ &#27979;&#35797;runner &#26041;&#27861;
&#20363;&#22914;: 
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">android {
    compileSdkVersion 19
    buildToolsVersion "19.0.0"

    defaultConfig {
        versionCode 12
        versionName "2.0"
        minSdkVersion 16
        targetSdkVersion 16
    }
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>&#19978;&#36848;&#25152;&#26377;&#30340;&#37197;&#32622;&#37117;&#25918;&#22312; <span class="bold">*android*</span> &#27573;&#30340; <span class="bold">*defaultConfig*</span> &#27573;&#20013;.

&#20043;&#21069;&#30340;android plugin&#29256;&#26412;,&#20351;&#29992; <span class="bold">*packageName*</span> &#23383;&#27573;&#26469;&#26367;&#20195; manifest&#25991;&#20214;
&#20013;&#30340; 'packageName'&#23383;&#27573;.
&#20174;0.11.0&#24320;&#22987;,&#36890;&#36807;&#22312;build.gradle&#25991;&#20214;&#20013;&#23450;&#20041; "applicationId"&#26469;&#23454;&#29616;&#19978;&#36848;&#26367;&#25442;.
&#20197;&#28040;&#38500;&#24212;&#29992;&#31243;&#24207;&#30340;&#21253;&#21517;&#21644;java&#21253;&#20043;&#38388;&#30340;&#28151;&#28102;.

&#22312;build&#25991;&#20214;&#20013;&#36827;&#34892;&#19978;&#36848;&#37197;&#32622;&#30340;&#19968;&#20010;&#20248;&#21183;&#26159;&#28789;&#27963;&#24615;&#39640;.&#20363;&#22914;,&#21487;&#20197;&#22312;&#20854;&#20182;&#25991;&#20214;&#25110;build&#25991;&#20214;
&#30340;&#20854;&#20182;&#22320;&#26041;&#23450;&#20041;&#19968;&#20010;&#20989;&#25968;&#24182;&#22312;defaultConfig&#20013;&#35843;&#29992;&#20182;.
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">def computeVersionName() {
    ...
}

android {
    compileSdkVersion 19
    buildToolsVersion "19.0.0"

    defaultConfig {
        versionCode 12
        versionName computeVersionName()
        minSdkVersion 16
        targetSdkVersion 16
    }
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>
&#22914;&#26524;&#27809;&#26377;&#22312;&#37197;&#32622;&#25991;&#20214;&#20013;&#35774;&#32622;&#26576;&#20010;&#23646;&#24615;,&#20250;&#20351;&#29992;&#40664;&#35748;&#20540;.&#22914;&#26524;&#40664;&#35748;&#20540;&#26159;null(&#19968;&#20123;property&#30340;
&#40664;&#35748;&#20540;&#26159;null),&#21017;&#22312;&#32534;&#35793;&#36807;&#31243;&#20013;&#20250;&#20351;&#29992;manifest&#25991;&#20214;&#20013;&#23450;&#20041;&#30340;&#20540;.
<span class="org-level-3">*** &#32534;&#35793;&#31867;&#22411;</span>
Android&#25554;&#20214;&#40664;&#35748;&#20250;&#32534;&#35793;&#20004;&#20010;&#31867;&#22411;&#30340;&#24212;&#29992;&#31243;&#24207;:debug&#21644;release&#29256;&#26412;.
debug&#29256;&#26412;&#20351;&#29992;&#19968;&#20010;"&#24050;&#30693;"&#30340;name/password&#26469;&#31614;&#21517;&#24212;&#29992;(&#36825;&#26679;&#22312;&#32534;&#35793;&#36807;&#31243;
&#19981;&#20250;&#26377;&#25552;&#31034;).

&#21487;&#20197;&#20351;&#29992;<span class="org-target">&lt;&lt;BuildType&gt;&gt;</span>&#26631;&#31614;&#26469;&#23545;&#32534;&#35793;&#31867;&#22411;&#20570;&#37197;&#32622;,&#40664;&#35748;&#26377;debug&#21644;release&#27573;.
&#21516;&#26102;&#21487;&#20197;&#21019;&#24314;&#20854;&#20182;&#30340;&#32534;&#35793;&#31867;&#22411;.

&#20363;&#22914;&#19979;&#38754;&#26377;&#20851;buildType&#30340;DSL&#37197;&#32622;&#65306;
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">android {
    buildTypes {
        debug {
            applicationIdSuffix ".debug"
        }

        jnidebug.initWith(buildTypes.debug)
        jnidebug {
            packageNameSuffix ".jnidebug"
            jniDebuggable true
        }
    }
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>&#19978;&#36848;&#37197;&#32622;&#23454;&#29616;&#20102;&#20197;&#19979;&#21151;&#33021;:
+ &#23545;&#40664;&#35748;&#30340; debug &#31867;&#22411;&#36827;&#34892;&#20102;&#23450;&#21046;:
  + &#23558;&#21253;&#21517;&#35774;&#32622;&#20026; "applicationId.debug"(&#28155;&#21152; debug &#21518;&#32512;).&#36825;&#26679;&#21487;&#20197;&#23454;&#29616;&#22312;&#19968;&#21488;&#26426;&#22120;&#19978;
    &#21516;&#26102;&#23433;&#35013; debug &#21253;&#21644; release &#21253;.
+ &#21019;&#24314;&#26032;&#32534;&#35793;&#31867;&#22411; jnidebug, &#35813;&#31867;&#22411;&#22797;&#21046;&#20102; debug &#31867;&#22411;.
+ &#23458;&#21046;&#21270; jnidebug &#31867;&#22411;,&#23558;&#21518;&#32512;&#25913;&#20026; "jnidebug",&#24182;&#24320;&#21551; jni &#35843;&#35797;&#21151;&#33021;.
&#20174;&#19978;&#38754;&#26159;&#31034;&#20363;&#21487;&#20197;&#30475;&#21040;,&#21019;&#24314;&#19968;&#20010;&#26032;&#30340;&#32534;&#35793;&#31867;&#22411;&#23601;&#26159;&#22312;"buildType"&#19979;&#38754;&#21019;&#24314;&#26032;&#30340;&#20803;&#32032;.&#21487;&#20197;&#36890;&#36807;
&#35843;&#29992;initWith()&#22797;&#21046;,&#20063;&#21487;&#20197;&#29992;&#22312;&#21518;&#38754;&#36319;&#22823;&#25324;&#21495;&#36827;&#34892;&#37197;&#32622;.
&#21487;&#20197;&#37197;&#32622;&#30340;&#23646;&#24615;&#21253;&#25324;:
TBD: &#20174;&#21407;&#22320;&#22336;&#25130;&#22270;&#25918;&#22312;&#36825;&#37324;.

&#38500;&#20102;&#19978;&#36848;&#23646;&#24615;,&#36824;&#21487;&#20197;&#22312;&#32534;&#35793;&#20195;&#30721;&#25110;&#36164;&#28304;&#30340;&#26102;&#20505;&#20351;&#29992;&#32534;&#35793;&#31867;&#22411;,&#23545;&#20110;&#27599;&#20010;&#32534;&#35793;&#31867;&#22411;,&#40664;&#35748;&#37117;&#20250;&#22312;
src&#30446;&#24405;&#19979;&#21019;&#24314;&#19968;&#20010;&#21516;&#21517;&#30446;&#24405;(&#25152;&#20197;&#33258;&#23450;&#20041;&#32534;&#35793;&#31867;&#22411;&#19981;&#33021;&#20026;main&#25110;androidTest).

&#20063;&#21487;&#20197;&#20351;&#29992;&#22914;&#19979;&#20195;&#30721;&#37325;&#23450;&#21521;&#32534;&#35793;&#31867;&#22411;&#30340;sourceSets.
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">android {
    sourceSets.jnidebug.setRoot('foo/jnidebug')
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>
&#21516;&#26102;,&#23545;&#20110;&#27599;&#20010;&#26032;&#30340;&#32534;&#35793;&#31867;&#22411;,&#37117;&#20250;&#21019;&#24314;&#19968;&#20010;&#30456;&#24212;&#30340; assemble&lt;BuildTypeName&gt; &#30340;&#20219;&#21153;.
&#25152;&#20197;&#19978;&#36848;&#31034;&#20363;&#20250;&#21019;&#24314;&#19968;&#20010;&#21517;&#20026;assembleJnidebug&#30340;&#20219;&#21153;.&#21516;&#26102;&#35813;&#20219;&#21153;&#20063;&#21521;assembleDebug&#21644;
assembleRelease&#19968;&#26679;,&#25104;&#20026;assemble&#20219;&#21153;&#30340;&#20381;&#36182;.
&#27880;: &#21516;&#26679;&#21487;&#20197;&#20351;&#29992;&#31616;&#20889; "gradle aJ"&#26469;&#36816;&#34892;&#35813;&#20219;&#21153;.

&#20851;&#20110;&#32534;&#35793;&#31867;&#22411;&#30340;&#36866;&#29992;&#22330;&#26223;:
+ debug&#29256;&#26412;&#21152;&#20837;&#19968;&#20123;"&#26435;&#38480;", release&#29256;&#26412;&#21435;&#25481;.
+ &#33258;&#23450;&#20041;&#35843;&#35797;
+ &#19981;&#21516;&#30340;&#27169;&#24335;&#20351;&#29992;&#19981;&#21516;&#30340;&#36164;&#28304;(&#20363;&#22914;&#22312;&#31614;&#21517;&#35748;&#35777;&#26102;&#20351;&#29992;&#19981;&#21516;&#30340;&#36164;&#28304;&#20540;).

&#27599;&#20010;&#23376;&#30446;&#24405;&#19979;&#30340;&#20195;&#30721;/&#36164;&#28304;&#25353;&#29031;&#20197;&#19979;&#21407;&#21017;&#20351;&#29992;:
+ manifest&#25991;&#20214;&#36319;app&#30340;manifest&#21512;&#24182;.
+ &#20195;&#30721;&#20316;&#20026;&#21478;&#22806;&#19968;&#20010;&#28304;&#30721;&#30446;&#24405;.
+ &#36164;&#28304;&#30446;&#24405;&#35206;&#30422;&#20027;&#30446;&#24405;&#20013;&#30340;&#30456;&#21516;&#20540;.

<span class="org-level-3">*** &#31614;&#21517;&#37197;&#32622;</span>
&#23545;&#19968;&#20010;&#24212;&#29992;&#20570;&#31614;&#21517;&#38656;&#35201;&#20197;&#19979;&#19996;&#35199;:
+ &#19968;&#20010;keystore
+ &#19968;&#20010;keystore &#23494;&#30721;
+ &#19968;&#20010;key&#21035;&#21517;
+ &#19968;&#20010;key&#23494;&#30721;
+ &#23384;&#20648;&#31867;&#22411;
&#19978;&#36848;&#20869;&#23481;&#32452;&#25104;&#20102;&#31614;&#21517;&#37197;&#32622;,&#21487;&#20197;&#22312;buildType&#20013;&#20351;&#29992;"signingConfig"&#26469;&#24341;&#29992;.

&#40664;&#35748;&#24773;&#20917;&#19979;,&#20250;&#22312;$HOME/.android/&#30446;&#24405;&#19979;&#21019;&#24314;&#19968;&#20010;debug.keystore&#25991;&#20214;.&#35813;&#25991;&#20214;&#23646;&#20110;&#40664;&#35748;&#30340;
debug&#37197;&#32622;,&#21363;&#26377;&#19968;&#20010;&#24050;&#30693;&#30340;"keystore&#23494;&#30721;+&#21035;&#21517;+&#23494;&#30721;". "debug&#32534;&#35793;&#31867;&#22411;"&#40664;&#35748;&#20351;&#29992;&#36825;&#20010;
"debug&#31614;&#21517;&#37197;&#32622;".

Android&#25554;&#20214;&#25903;&#25345;&#31614;&#21517;&#37197;&#32622;&#30340;&#21019;&#24314;&#21644;&#23458;&#21046;&#21270;.&#36890;&#36807;<span class="org-target">&lt;&lt;signingConfigs&gt;&gt;</span>&#26469;&#23454;&#29616;.&#20363;&#22914;:
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">android {
    signingConfigs {
        debug {
            storeFile file("debug.keystore")
        }

        myConfig {
            storeFile file("other.keystore")
            storePassword "android"
            keyAlias "androiddebugkey"
            keyPassword "android"
        }
    }

    buildTypes {
        foo {
            debuggable true
            jniDebuggable true
            signingConfig signingConfigs.myConfig
        }
    }
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>&#19978;&#36848;&#20195;&#30721;&#20462;&#25913;&#20102;debug&#32534;&#35793;&#31867;&#22411;&#30340;keystore&#25991;&#20214;&#20301;&#32622;.&#24182;&#21019;&#24314;&#20102;&#19968;&#20010;&#26032;&#30340;&#31614;&#21517;&#37197;&#32622;&#21644;&#19968;&#20010;&#20351;&#29992;
&#35813;&#31614;&#21517;&#37197;&#32622;&#30340;&#26032;&#32534;&#35793;&#31867;&#22411;.

&#27880;:&#19968;&#33324;&#24773;&#20917;&#19979;,keystore&#25991;&#20214;&#23384;&#20110;&#24037;&#31243;&#30340;&#26681;&#30446;&#24405;&#19979;,&#20294;&#26159;&#20063;&#21487;&#20197;&#20351;&#29992;&#32477;&#23545;&#36335;&#24452;(&#19981;&#25512;&#33616;,&#21487;&#33021;&#20250;&#30001;&#20110;
&#25805;&#20316;&#31995;&#32479;&#30340;&#19981;&#21516;&#32780;&#23548;&#33268;&#38382;&#39064;.&#20294;&#26159;&#40664;&#35748;&#30340;debug&#32534;&#35793;&#31867;&#22411;&#38500;&#22806;).

&#27880;:&#22914;&#26524;&#24037;&#31243;&#20351;&#29992;&#29256;&#26412;&#25511;&#21046;&#31995;&#32479;.&#23613;&#37327;&#19981;&#35201;&#23558;&#23494;&#30721;&#23384;&#22312;&#25991;&#20214;&#37324;.&#21487;&#20197;&#21442;&#32771;stackoverflow&#19978;&#30340;&#36825;&#20010;&#24086;&#23376;.
<span class="org-link"><a href="http://stackoverflow.com/questions/18328730/how-to-create-a-release-signed-apk-file-using-gradle">http://stackoverflow.com/questions/18328730/how-to-create-a-release-signed-apk-file-using-gradle</a></span>.

<span class="org-level-3">*** &#36816;&#34892;ProGuard&#28151;&#28102;</span>
Gradle&#25554;&#20214;&#25903;&#25345;4.10&#29256;&#26412;&#30340;ProGuard. ProGuard&#25554;&#20214;&#40664;&#35748;&#26159;&#21551;&#29992;&#30340;.&#22914;&#26524;&#22312;"&#32534;&#35793;&#31867;&#22411;"&#20013;&#35774;&#32622;&#20102;
<span class="bold">*minifyEnable*</span> &#23646;&#24615;.&#20250;&#33258;&#21160;&#21019;&#24314;&#30456;&#20851;&#20219;&#21153;.&#20363;&#22914;&#22312;&#32534;&#35793;&#31867;&#22411;&#21644;flavor&#20013;&#20351;&#29992;ProGuard:
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">android {
    buildTypes {
        release {
            minifyEnabled true
            proguardFile getDefaultProguardFile('proguard-android.txt')
        }
    }

    productFlavors {
        flavor1 {
        }
        flavor2 {
            proguardFile 'some-other-rules.txt'
        }
    }
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>&#40664;&#35748;&#26377;&#20004;&#20010;&#35268;&#21017;&#25991;&#20214;:
+ proguard-android.txt
+ proguard-android-optimize.txt
&#23427;&#20204;&#20301;&#20110;SDK&#20013;,&#21487;&#20197;&#36890;&#36807;getDefaultProguardFile()&#20989;&#25968;&#36820;&#22238;&#25991;&#20214;&#36335;&#24452;.&#38500;&#20102;&#21551;&#29992;&#20248;&#21270;&#21151;&#33021;&#22806;,
&#36825;&#20004;&#20010;&#25991;&#20214;&#30340;&#20869;&#23481;&#26159;&#19968;&#26679;&#30340;.

<span class="org-level-3">*** &#21387;&#32553;&#36164;&#28304;</span>
&#21487;&#20197;&#22312;&#32534;&#35793;&#26399;&#38388;&#33258;&#21160;&#31227;&#38500;&#27809;&#29992;&#30340;&#36164;&#28304;.&#20855;&#20307;&#21487;&#20197;&#21442;&#32771;<span class="org-link"><a href="http://tools.android.com/tech-docs/new-build-system/resource-shrinking">http://tools.android.com/tech-docs/new-build-system/resource-shrinking</a></span>.

<span class="org-level-1">* &#20381;&#36182;,&#24211;&#20197;&#21450;&#22810;&#24037;&#31243;&#35774;&#32622;</span>
&#19968;&#20010;gradle&#24037;&#31243;&#21487;&#33021;&#20250;&#20381;&#36182;&#20854;&#20182;&#30340;&#32452;&#20214;,&#36825;&#20123;&#32452;&#20214;&#21487;&#20197;&#26159;&#24211;&#25110;&#32773;&#20854;&#20182;gradle&#24037;&#31243;.
<span class="org-level-2">** &#20381;&#36182;&#20108;&#36827;&#21046;&#21253;</span>
<span class="org-level-3">*** &#26412;&#22320;&#21253;</span>
&#24403;&#38656;&#35201;&#20351;&#29992;&#22806;&#37096;&#30340;jar&#21253;&#26102;,&#38656;&#35201;&#22312;<span class="org-target">&lt;&lt;dependencies&gt;&gt;</span>&#27573;&#20013;&#28155;&#21152;<span class="org-target">&lt;&lt;compile&gt;&gt;</span>&#37197;&#32622;(dependencies&#26159;&#26631;&#20934;&#30340;DSL&#20803;&#32032;,&#19981;&#23646;&#20110;android&#27573;).
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">dependencies {
    compile files('libs/foo.jar')
}

android {
    ...
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span><span class="bold">*compile*</span> &#37197;&#32622;&#19968;&#33324;&#29992;&#20110;&#37197;&#32622;&#20027;&#24037;&#31243;.&#36825;&#20123;jar&#21253;&#20250;&#34987;&#28155;&#21152;&#21040;&#32534;&#35793;&#36335;&#24452;&#24182;&#21253;&#20837;&#26368;&#21518;&#30340;APK&#20013;.
&#20854;&#20182;&#21487;&#20197;&#28155;&#21152;&#30340;&#20381;&#36182;&#21253;&#25324;:
+ compile: &#20027;&#24037;&#31243;
+ androidTestCompile: &#27979;&#35797;&#24037;&#31243;
+ debugCompile: debug&#32534;&#35793;&#31867;&#22411;
+ releaseCompile: release&#32534;&#35793;&#31867;&#22411;
&#27599;&#21019;&#24314;&#19968;&#20010;&#26032;&#30340;&#31867;&#22411;,&#37117;&#20250;&#33258;&#21160;&#21019;&#24314;&#19968;&#20010;&#31867;&#20284;"&lt;buildtype&gt;Compile"&#30340;&#37197;&#32622;.
&#22914;&#26524;&#19981;&#21516;&#30340;&#32534;&#35793;&#31867;&#22411;&#38656;&#35201;&#19981;&#21516;&#30340;&#24211;&#20381;&#36182;(&#25110;&#20381;&#36182;&#24211;&#30340;&#19981;&#21516;&#29256;&#26412;),&#19978;&#36848;&#37197;&#32622;&#20250;&#24456;&#26377;&#29992;.
<span class="org-level-3">*** &#36828;&#31243;&#32452;&#20214;</span>
Gradle&#25903;&#25345;&#20174;Maven&#21644;Ivy&#24211;&#20013;&#19979;&#36733;&#20381;&#36182;&#24211;.
&#39318;&#20808;&#23558;&#20179;&#24211;&#28155;&#21152;&#21040; <span class="bold">*repositories*</span> &#27573;&#20013;.&#28982;&#21518;&#22312; <span class="bold">*dependencies*</span> &#20013;&#28155;&#21152;&#20381;&#36182;.
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">repositories {
    mavenCentral()
}

dependencies {
    compile 'com.google.guava:guava:11.0.2'
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>&#27880;: Gradle&#25903;&#25345;&#26412;&#22320;&#21644;&#36828;&#31471;&#20179;&#24211;.
&#27880;: &#22914;&#26524;&#20381;&#36182;&#33258;&#36523;&#20063;&#26377;&#20381;&#36182;&#30340;&#35805;,&#37117;&#20250;&#34987;&#19979;&#36733;.
&#20855;&#20307;&#20351;&#29992;&#21487;&#20197;&#21442;&#32771;<span class="org-link"><a href="http://gradle.org/docs/current/userguide/artifact_dependencies_tutorial.html">http://gradle.org/docs/current/userguide/artifact_dependencies_tutorial.html</a></span>
&#21644; <span class="org-link"><a href="http://gradle.org/docs/current/dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html">http://gradle.org/docs/current/dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html</a></span>.

<span class="org-level-2">** &#22810;&#24037;&#31243;&#35774;&#32622;</span>
&#21487;&#20197;&#36890;&#36807;&#22810;&#24037;&#31243;&#35774;&#32622;&#26469;&#20351;&#19968;&#20010;gradle&#24037;&#31243;&#20381;&#36182;&#20854;&#20182;&#30340;gradle&#24037;&#31243;.&#19968;&#33324;&#30340;&#22810;&#24037;&#31243;&#35774;&#32622;
&#26159;&#36890;&#36807;&#22312;&#39033;&#30446;&#26681;&#30446;&#24405;&#19979;&#28155;&#21152;&#23376;&#30446;&#24405;&#26469;&#23454;&#29616;&#30340;.&#20363;&#22914;:
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">MyProject/
 + app/
 + libraries/
    + lib1/
    + lib2/
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>&#19978;&#36848;&#20195;&#30721;&#35774;&#32622;&#20102;&#19977;&#20010;&#24037;&#31243;:
+ :app
+ :libraries:lib1
+ :libraries:lib2
&#27599;&#20010;&#24037;&#31243;&#37117;&#26377;&#33258;&#24049;&#30340;"build.gradle"&#25991;&#20214;.&#21478;&#22806;,&#22312;&#26681;&#30446;&#24405;&#19979;&#38656;&#35201;&#23450;&#20041;"settings.gradle"
&#25991;&#20214;&#26469;&#22768;&#26126;&#36825;&#20123;&#24037;&#31243;.&#25152;&#20197;&#26368;&#21518;&#26550;&#26500;&#21464;&#20026;:
+ RootProject
  - settings.gradle
  + app/
    - build.gradle
  + libraries
    + lib1/
      - build.gradle
    + lib2/
      - build.gradle

"settings.gradle"&#25991;&#20214;&#30340;&#20869;&#23481;&#20026;:"include ':app', ':libraries:lib1', ':libraries:lib2'";
&#25991;&#20214;&#23450;&#20041;&#20102;&#37027;&#20123;&#30446;&#24405;&#26159;&#19968;&#20010;gradle&#24037;&#31243;.

&#22914;&#26524;gradle&#24037;&#31243;&#20043;&#38388;&#26377;&#20381;&#36182;&#30340;&#35805;,&#21487;&#20197;&#20570;&#22914;&#19979;&#35774;&#32622;.
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">dependencies {
    compile project(':libraries:lib1')
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>&#26356;&#22810;&#20449;&#24687;&#21442;&#32771;<span class="org-link"><a href="http://gradle.org/docs/current/userguide/multi_project_builds.html">http://gradle.org/docs/current/userguide/multi_project_builds.html</a></span>.
<span class="org-level-2">** &#24211;&#24037;&#31243;&#35774;&#32622;</span>
&#22312;&#19978;&#19968;&#33410;&#20013;,":libraries:lib1"&#21644;":libraries:lib2"&#21487;&#20197;&#26159;java&#24037;&#31243;,":app"&#20250;
&#20351;&#29992;&#23427;&#20204;&#29983;&#25104;&#30340;jar&#21253;.
&#22914;&#26524;&#19978;&#38754;&#30340;&#24211;&#35201;&#20351;&#29992;android&#30340;API,&#24212;&#35813;&#23558;&#23427;&#20204;&#23450;&#20041;&#25104;Android&#24211;&#24037;&#31243;.
<span class="org-level-3">*** &#21019;&#24314;Android&#24211;&#24037;&#31243;</span>
&#21019;&#24314;&#19968;&#20010;android&#24211;&#24037;&#31243;&#38656;&#35201;&#20351;&#29992;&#19968;&#20010;&#19981;&#21516;&#30340;plugin.
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">buildscript {
    repositories {
        mavenCentral()
    }

    dependencies {
        classpath 'com.android.tools.build:gradle:0.5.6'
    }
}

apply plugin: 'android-library'

android {
    compileSdkVersion 15
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span><span class="org-level-3">*** &#24037;&#31243;&#21644;&#24211;&#24037;&#31243;&#30340;&#21306;&#21035;</span>
&#19968;&#20010;&#24211;&#24037;&#31243;&#20250;&#32534;&#35793;&#20026;"aar"(Android archive)&#21253;.&#35813;&#21253;&#25972;&#21512;&#20102;&#20195;&#30721;&#21644;&#36164;&#28304;.&#21516;&#26102;&#20063;&#21487;&#20197;&#22312;&#24211;&#24037;&#31243;&#20013;
&#32534;&#35793;&#27979;&#35797;APK&#26469;&#23545;&#24211;&#20570;&#27979;&#35797;.

&#20854;&#20182;&#30340;&#22522;&#26412;&#19982;&#27491;&#24120;&#30340;&#24037;&#31243;&#30456;&#21516;.
<span class="org-level-2">** &#24341;&#29992;&#24211;</span>
&#24211;&#24341;&#29992;&#21644;&#20854;&#20182;&#30340;&#24037;&#31243;&#24341;&#29992;&#19968;&#26679;,&#38656;&#35201;&#22312;dependencies&#20013;&#28155;&#21152; "compile project"&#21363;&#21487;.
<span class="org-level-3">*** &#24211;&#21457;&#24067;</span>
&#40664;&#35748;&#24773;&#20917;&#19979;,&#24211;&#21482;&#21457;&#24067;release&#29256;&#26412;,&#26080;&#35770;&#20381;&#36182;&#35813;&#24211;&#30340;&#20854;&#20182;&#24037;&#31243;&#21457;&#24067;&#30340;&#26159;&#37027;&#20010;&#29256;&#26412;.
&#21487;&#20197;&#36890;&#36807;&#37197;&#32622;&#26469;&#25511;&#21046;&#21457;&#24067;&#37027;&#20010;&#29256;&#26412;:
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">android {
    defaultPublishConfig "debug"
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#37197;&#32622;&#21517;&#24517;&#39035;&#20026;&#20840;&#21517;,&#22914;&#26524;&#38656;&#35201;&#20351;&#29992;flavor,&#35201;&#20889;&#25104;"flavorDebug"&#30340;&#24418;&#24335;.

&#20063;&#21487;&#20197;&#36890;&#36807;&#37197;&#32622;&#26469;&#21462;&#28040;&#40664;&#35748;&#30340;&#21457;&#24067;.&#36825;&#26679;&#20250;&#23548;&#33268;&#29983;&#20135;&#25152;&#26377;&#29256;&#26412;&#30340;aar&#25991;&#20214;.
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">android {
   publishNonDefault true
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span><span class="org-level-1">* &#27979;&#35797;</span>
Gradle&#25554;&#20214;&#22312;&#24212;&#29992;&#30340;&#24037;&#31243;&#20013;&#25972;&#21512;&#20102;&#27979;&#35797;&#24037;&#31243;.
<span class="org-level-2">** &#21333;&#20803;&#27979;&#35797;</span>
&#22312;Android Studio1.1&#29256;&#26412;&#20013;&#24341;&#20837;&#20102;&#21333;&#20803;&#27979;&#35797;&#25903;&#25345;,&#19981;&#36807;&#30446;&#21069;&#36824;&#22312;&#35797;&#39564;&#38454;&#27573;, &#25991;&#26723;&#21442;&#32771;<span class="org-link"><a href="http://tools.android.com/tech-docs/unit-testing-support">http://tools.android.com/tech-docs/unit-testing-support</a></span>.
<span class="org-level-2">** &#22522;&#26412;&#37197;&#32622;</span>
&#21069;&#38754;&#25552;&#21040;,&#22312;&#24037;&#31243;&#30340;src&#30446;&#24405;&#19979;&#19968;&#33324;&#21253;&#25324;main&#30446;&#24405;&#21644;androidTest&#30446;&#24405;.
&#35813;&#30446;&#24405;&#36890;&#36807;&#20351;&#29992;Android&#27979;&#35797;&#26694;&#26550;&#26469;&#29983;&#20135;&#21487;&#20197;&#23433;&#35013;&#22312;&#35774;&#22791;&#19978;&#30340;&#27979;&#35797;APK&#25991;&#20214;.

&#21487;&#20197;&#22312;&#27979;&#35797;&#30446;&#24405;&#19979;&#21019;&#24314;AndroidManifest.xml&#25991;&#20214;&#23450;&#20041;&#20854;&#20182;&#32452;&#20214;.

&#22312;build.gradle&#30340;android&#27573;&#20013;&#21487;&#20197;&#37197;&#32622;&#20197;&#19979;&#23646;&#24615;:
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">android {
    defaultConfig {
        testPackageName "com.test.foo"
        testInstrumentationRunner "android.test.InstrumentationTestRunner"
        testHandleProfiling true
        testFunctionalTest true
    }
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>targetPackage&#23646;&#24615;&#20250;&#33258;&#21160;&#34987;&#35774;&#32622;&#20026;test&#31243;&#24207;&#30340;package&#21517;&#31216;,&#21363;&#20351;&#36890;&#36807;defaultConfig&#25110;&#20854;&#20182;
&#32534;&#35793;&#36873;&#39033;&#36827;&#34892;&#37197;&#32622;.

&#21478;&#22806;,&#21487;&#20197;&#23545;test&#24037;&#31243;&#21333;&#29420;&#35774;&#32622;&#20381;&#36182;,&#26631;&#31614;&#20026;"androidTestCompile". 
&#32534;&#35793;test&#24037;&#31243;&#20351;&#29992;"assembleTest"&#20219;&#21153;,&#35813;&#20219;&#21153;&#19981;&#26159;"assemble"&#20219;&#21153;&#30340;&#20381;&#36182;.
&#30446;&#21069;&#40664;&#35748;&#24773;&#20917;&#19979;&#21482;&#26377;"debug&#32534;&#35793;&#31867;&#22411;"&#34987;&#27979;&#35797;.&#21487;&#20197;&#36890;&#36807; "testBuildType name"&#26469;&#37197;&#32622;&#35201;&#27979;&#35797;&#30340;
&#32534;&#35793;&#31867;&#22411;.
<span class="org-level-2">** </span><span class="org-todo">TODO</span><span class="org-level-2"> &#36816;&#34892;&#27979;&#35797;</span>
<span class="org-level-2">** </span><span class="org-todo">TODO</span><span class="org-level-2"> &#27979;&#35797;&#24211;</span>
<span class="org-level-1">* &#32534;&#35793;&#21464;&#37327;</span>
&#26032;&#32534;&#35793;&#31995;&#32479;&#30340;&#19968;&#20010;&#30446;&#26631;&#23601;&#26159;&#21487;&#20197;&#21019;&#24314;&#21516;&#19968;&#20010;&#31243;&#24207;&#30340;&#19981;&#21516;&#29256;&#26412;.
&#38656;&#35201;&#36825;&#20040;&#20570;&#30340;&#21407;&#22240;:
1. &#21487;&#33021;&#38656;&#35201;&#19968;&#20010;&#31243;&#24207;&#30340;&#19981;&#21516;&#29256;&#26412;:&#20363;&#22914; &#20813;&#36153;/demo&#29256; VS "&#19987;&#19994;"&#20184;&#36153;&#29256;.
2. Google Play Store&#38656;&#35201;&#19978;&#20256;&#22810;&#20010;&#29256;&#26412;&#30340;APK&#25991;&#20214;,&#21442;&#32771;<span class="org-link"><a href="http://developer.android.com/google/play/publishing/multiple-apks.html">http://developer.android.com/google/play/publishing/multiple-apks.html</a></span>.
3. &#21516;&#26102;&#38656;&#35201;&#20570;1&#21644;2.

&#25152;&#20197;&#26032;&#29256;&#26412;&#30340;&#30446;&#26631;&#23601;&#26159;&#21487;&#20197;&#28385;&#36275;&#19978;&#36848;&#38656;&#35201;,&#33021;&#22815;&#20351;&#29992;&#19968;&#20010;&#24037;&#31243;&#29983;&#25104;&#19981;&#21516;APK.
&#32780;&#19981;&#26159;&#20026;&#20102;&#32534;&#35793;&#19981;&#21516;&#30340;APK&#21019;&#24314;&#22810;&#20010;&#24037;&#31243;.
<span class="org-level-2">** &#20135;&#21697;flavors</span>
&#36890;&#36807;flavor&#21487;&#20197;&#23458;&#21046;&#21270;&#24037;&#31243;&#32534;&#35793;&#20986;&#26469;&#30340;&#20135;&#21697;.&#19968;&#20010;&#24037;&#31243;&#21487;&#20197;&#26377;&#22810;&#20010;flavor.
flavor&#36825;&#20010;&#27010;&#24565;&#36890;&#24120;&#29992;&#20110;&#25913;&#21464;&#38750;&#24120;&#23567;&#30340;&#22330;&#26223;.

&#20351;&#29992;DSL&#30340; <span class="bold">*productFlavor*</span> &#20851;&#38190;&#23383;&#26469;&#23450;&#20041;flavor.
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">android {
    productFlavors {
        flavor1 {
            ...
        }

        flavor2 {
            ...
        }
    }
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>&#19978;&#36848;&#20195;&#30721;&#21019;&#24314;&#20102;&#20004;&#20010;flavor: flavor1&#21644;flavor2.
&#35760;&#20303;flavor&#30340;&#21517;&#23383;&#19981;&#33021;&#19982; <span class="bold">*&#32534;&#35793;&#31867;&#22411;*</span> &#21644; <span class="bold">*androidTest&#30340;sourceSet*</span> &#28151;&#28102;.
<span class="org-level-2">** &#32534;&#35793;&#21464;&#37327;=&#32534;&#35793;&#31867;&#22411;+&#20135;&#21697;flavor</span>
&#21069;&#38754;&#35762;&#36807;,&#27599;&#20010;&#32534;&#35793;&#31867;&#22411;&#37117;&#20250;&#29983;&#25104;&#19968;&#20010;APK.
Flavor&#21487;&#20197;&#23436;&#25104;&#21516;&#26679;&#30340;&#21151;&#33021;: &#25152;&#20197;&#19968;&#20010;&#24037;&#31243;&#21487;&#20197;&#29983;&#25104;&#30340;APK&#26159;&#25152;&#26377;&#32534;&#35793;&#31867;&#22411;
&#21644;flavor&#30340;&#32452;&#21512;.&#27599;&#20010;&#32452;&#21512;&#34987;&#31216;&#20316;&#32534;&#35793;&#21464;&#37327;.

&#20363;&#22914;,&#21069;&#38754;&#23450;&#20041;&#30340;&#20004;&#20010;flavor,&#20877;&#21152;&#19978;&#31995;&#32479;&#40664;&#35748;&#30340;debug&#21644;release&#32534;&#35793;&#31867;&#22411;,&#21487;&#20197;&#29983;&#25104;
&#22235;&#31181;&#32534;&#35793;&#21464;&#37327;:
+ Flavor1-debug
+ Flavor2-debug
+ Flavor1-release
+ Flavor2-release
<span class="org-level-2">** Flavor&#37197;&#32622;</span>
flavor&#30340;&#37197;&#32622;&#36319;&#20854;&#20182;&#30340;&#37197;&#32622;&#19968;&#26679;,&#27599;&#20010;flavor&#37117;&#35201;&#29992;&#22823;&#25324;&#21495;&#25324;&#36215;&#26469;.
&#20363;&#22914;:
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">android {
    ...

    defaultConfig {
        minSdkVersion 8
        versionCode 10
    }

    productFlavors {
        flavor1 {
            packageName "com.example.flavor1"
            versionCode 20
        }

        flavor2 {
            packageName "com.example.flavor2"
            minSdkVersion 14
        }
    }
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>&#38656;&#35201;&#35828;&#26126;&#30340;&#26159;androd.productFlavors.*&#23545;&#35937;&#23646;&#20110;<span class="org-target">&lt;&lt;ProductFlavor&gt;&gt;</span>&#31867;&#22411;,&#35813;&#31867;&#22411;
&#19982;&#21069;&#38754;&#25552;&#21040;&#30340;android.defaultConfig&#31867;&#22411;&#20849;&#20139;&#21516;&#26679;&#30340;&#23646;&#24615;.
&#25152;&#20197;&#27599;&#20010;flavor&#37117;&#21487;&#20197;&#37325;&#20889;defaultConfig&#25552;&#20379;&#30340;<span class="org-target">&lt;&lt;&#37096;&#20998;&gt;&gt;</span>&#37197;&#32622;.&#20363;&#22914;&#19978;&#38754;&#30340;&#20195;&#30721;&#26368;&#21518;&#21019;&#24314;&#20102;&#22914;
&#19979;&#20004;&#20010;flavor:
+ flavor1
  + packagName: com.example.flavor1
  + minSdkVersion: 8
  + versionCode: 20
+ flavor2
  + packageName: com.example.flavor2
  + minSdkVersion: 14
  + versionCode: 10
&#36890;&#24120;,&#32534;&#35793;&#31867;&#22411;&#30340;&#37197;&#32622;&#20250;&#21644;flavor&#30340;&#37197;&#32622;"&#21512;&#24182;', &#20363;&#22914;&#22312;&#32534;&#35793;&#31867;&#22411;&#20013;&#37197;&#32622;&#20102;"packageNameSuffix",
&#37027;&#20040;&#26368;&#21518;&#29983;&#25104;&#30340;&#34920;&#21517;&#23601;&#31561;&#20110;flavor&#20013;&#37197;&#32622;&#30340;"packageName"&#21152;&#19978;&#35813;suffix.

&#23545;&#20110;&#32534;&#35793;&#31867;&#22411;&#21644;flavor&#37117;&#21487;&#20197;&#37197;&#32622;&#30340;&#23646;&#24615;, &#35201;&#26681;&#25454;&#38656;&#27714;&#35774;&#32622;.&#20363;&#22914;signingConfig&#23646;&#24615;,&#22914;&#26524;
&#24819;&#35201;&#35774;&#32622;&#25152;&#26377;&#30340;release&#21253;&#20351;&#29992;&#21516;&#19968;&#20010;SigningConfig.&#21487;&#20197;&#35774;&#32622; <span class="bold">*android.buildTypes.release.signingConfig*</span>,
&#25110;&#32773;&#20026;&#27599;&#20010;flavor&#21333;&#29420;&#35774;&#32622;&#35813;&#23646;&#24615;.
<span class="org-level-2">** &#36164;&#28304;&#38598;&#21644;&#20381;&#36182;</span>
&#21644;&#32534;&#35793;&#31867;&#22411;&#19968;&#26679;,Flavor&#21516;&#26679;&#20063;&#26377;&#33258;&#24049;&#30340;&#20195;&#30721;&#21644;&#36164;&#28304;&#30446;&#24405;.
&#20363;&#22914;&#19978;&#19968;&#33410;&#30340;&#20363;&#23376;&#21019;&#24314;&#20986;&#22914;&#19979;&#30340;&#36164;&#28304;&#38598;&#21512;:
+ android.sourceSets.flavor1
  Location: src/flavor1
+ android.sourceSets.flavor2
  Location: src/flavor2
+ android.sourceSets.androidTestFlavor1
  Location: src/androidTestFlavor1
+ android.sourceSets.androidTestFlavor2
  Location: src/androidTestFlavor2

&#36825;&#20123;&#36164;&#28304;&#38598;&#21512;&#19982; <span class="bold">*android.sourceSets.main+&#32534;&#35793;&#31867;&#22411;*</span> &#19968;&#36215;&#29983;&#25104;&#26368;&#21518;&#30340;APK&#25991;&#20214;.
&#36825;&#20010;&#36807;&#31243;&#20250;&#36981;&#24490;&#22914;&#19979;&#35268;&#21017;:
1. &#20351;&#29992;&#25152;&#26377;&#30340;&#30456;&#20851;&#20195;&#30721;&#30446;&#24405;&#20849;&#21516;&#32534;&#35793;APK.
2. &#25152;&#26377;&#30340;manifest&#25991;&#20214;&#34987;&#21512;&#24182;&#20026;&#19968;&#20010;&#25991;&#20214;.&#36825;&#20351;&#24471;flavors&#21487;&#20197;&#20687;&#32534;&#35793;&#31867;&#22411;&#19968;&#26679;,&#21487;&#20197;
   &#26377;&#19981;&#21516;&#30340;&#32452;&#20214;&#21644;&#26435;&#38480;.
3. &#36164;&#28304;&#20351;&#29992;"&#35206;&#30422;"&#31574;&#30053;,&#32534;&#35793;&#31867;&#22411;&#35206;&#30422;flavor, flavor&#35206;&#30422;main.
4. &#27599;&#20010;&#32534;&#35793;&#21464;&#37327;&#37117;&#29983;&#25104;&#33258;&#24049;&#30340;R&#31867;. &#32534;&#35793;&#21464;&#37327;&#20043;&#38388;&#19981;&#20849;&#20139;.

&#21516;&#26102;,flavor&#20063;&#21487;&#20197;&#35774;&#32622;&#33258;&#24049;&#30340;&#20381;&#36182;.&#20363;&#22914;,&#22914;&#26524;&#19968;&#20010;flavor&#29256;&#26412;&#38656;&#35201;&#29983;&#25104;&#19968;&#20010;&#26377;&#24191;&#21578;&#30340;&#29256;&#26412;
&#25110;&#19968;&#20010;&#25910;&#36153;&#29256;&#26412;,&#21487;&#20197;&#20026;&#35813;flavor&#35774;&#32622;&#20381;&#36182;&#24191;&#21578;SDK.
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">dependencies {
  flavor1Compile "..."
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>
&#27599;&#20010;&#32534;&#35793;&#21464;&#37327;&#37117;&#20250;&#29983;&#25104;&#30456;&#24212;&#30340;&#36164;&#28304;&#38598;&#21512;:
+ android.sourceSets.flavor1Debug
  Location: src/flavor1Debug
+ android.sourceSets.flavor2Debug
  Location: src/flavor2Debug
...
&#36825;&#20123;&#30446;&#24405;&#30340;&#20248;&#20808;&#32423;&#35201;&#39640;&#20110;&#32534;&#35793;&#31867;&#22411;&#30340;&#20248;&#20808;&#32423;,&#24182;&#21487;&#20197;&#23458;&#21046;&#21270;.
<span class="org-level-2">** &#32534;&#35793;&#21644;&#20219;&#21153;</span>
&#21069;&#38754;&#30340;&#20869;&#23481;&#35828;&#36807;,&#27599;&#20010;&#32534;&#35793;&#31867;&#22411;&#37117;&#26377;&#33258;&#24049;&#30340; <span class="bold">*assemble&lt;name&gt;*</span> &#20219;&#21153;,&#20294;&#26159;&#22240;&#20026;
&#32534;&#35793;&#21464;&#37327;&#26159;&#32534;&#35793;&#31867;&#22411;&#21644;flavor&#30340;&#32452;&#21512;.&#25152;&#20197;&#24403;&#20351;&#29992;flavor&#26102;,&#20250;&#26377;&#22810;&#20010;assemble&#31867;&#22411;
&#30340;&#20219;&#21153;&#34987;&#21019;&#24314;.&#23427;&#20204;&#26159;:
1. assemble&lt;&#32534;&#35793;&#21464;&#37327;&gt;
2. assemble&lt;&#32534;&#35793;&#31867;&#22411;&gt;
3. assemble&lt;Flavor&gt;
&#20351;&#29992;&#21487;&#20197;&#29983;&#25104;&#19968;&#20010;APK. &#20351;&#29992;2&#21487;&#20197;&#32534;&#35793;&#25152;&#26377;&#35813;&#32534;&#35793;&#31867;&#22411;&#30340;APK(&#20363;&#22914;flavorDebug&#21644;flavor2Debug).
&#20351;&#29992;3&#21487;&#20197;&#32534;&#35793;&#25152;&#26377;&#35813;flavor&#30340;APK(flavorDebug/flavorRelease).
<span class="org-level-2">** &#27979;&#35797;</span>
&#27979;&#35797;&#22810;&#20010;flavor&#24037;&#31243;&#19982;&#27979;&#35797;&#21333;&#20010;&#24037;&#31243;&#21644;&#30456;&#20284;. &#20351;&#29992; <span class="bold">*androidTest*</span> &#21487;&#20197;&#20026;&#25152;&#26377;&#30340;
flavor&#20570;&#19968;&#33324;&#27979;&#35797;.&#27599;&#20010;flavor&#36824;&#21487;&#20197;&#35774;&#32622;&#33258;&#24049;&#30340;&#27979;&#35797;.

&#27599;&#20010;flavor&#37117;&#20250;&#21019;&#24314;&#30456;&#24212;&#30340;&#36164;&#28304;&#38598;&#21512;:
+ android.sourceSets.androidTestFlavor1
  Location: src/androidTestFlavor1
+ android.sourceSets.androidTestFlavor2
  Location: src/androidTestFlavor2

&#21516;&#26679;, &#23427;&#20204;&#21487;&#20197;&#37197;&#32622;&#30456;&#20851;&#30340;&#20381;&#36182;:
<span class="org-block-begin-line">#+BEGIN_EXAMPLE 
</span><span class="org-block">dependencies {
    androidTestFlavor1Compile "..."
}
</span><span class="org-block-end-line">#+END_EXAMPLE
</span>
&#21487;&#20197;&#36890;&#36807; <span class="bold">*deviceCheck*</span> &#25110; <span class="bold">*androidTest*</span> &#20219;&#21153;&#26469;&#36816;&#34892;&#25152;&#26377;&#30340;&#27979;&#35797;&#20219;&#21153;.
&#27599;&#20010;flavor&#20063;&#26377;&#33258;&#24049;&#30340;&#27979;&#35797;&#20219;&#21153; androidTest&lt;&#21517;&#31216;&gt;:
+ assembleFlavor1Test
+ installFlavor1Debug
+ installFlavor1Test
+ uninstallFlavor1Debug

&#20219;&#21153;&#23436;&#25104;&#29983;&#25104;&#30340;HTML&#32467;&#26524;&#25903;&#25345;flavor&#38598;&#21512;.&#27979;&#35797;&#32467;&#26524;&#30340;&#20301;&#23376;&#22914;&#19979;&#20363;&#25152;&#36848;,&#20808;&#26159;flavor&#29256;&#26412;,
&#28982;&#21518;&#26159;&#38598;&#21512;&#29256;&#26412;.&#21487;&#20197;&#23545;root&#30446;&#24405;(build)&#20570;&#23458;&#21046;&#21270;.
+ build/androidTest-results/flavors/&lt;FlavorName&gt;
+ build/androidTest-results/all/
+ build/reports/androidTests/flavors&lt;FlavorName&gt;
+ build/reports/androidTests/all/
<span class="org-level-2">** </span><span class="org-todo">TODO</span><span class="org-level-2"> &#22810;flavor&#21464;&#37327;</span>
<span class="org-level-1">* </span><span class="org-todo">TODO</span><span class="org-level-1"> &#39640;&#32423;&#37197;&#32622;</span>
</pre>
  </body>
</html>
